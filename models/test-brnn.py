import numpy as np
import brnn

feat = ["press_mx", "press_mn", "temp_dx", "H_mn","temp_auc", "H_mx", "DP_mn", "H_auc", "DP_mx", "temp_mx"]

theta = np.array([[0.7558469,1.4196087,13.3567624,-14.2719220,4.8489190,-4.2652464,-7.4270294,6.1746705,10.3477186,-2.4859905,-17.1408236,2.1748635],
                  [-2.9567307,0.7545881,0.0917480,0.1211966,2.3576010,-0.5031790,-4.5222698,1.0737810,0.2674564,-1.4012162,-2.2115969,0.9595911],
                  [-0.8447088,-20.4134519,-45.8800383,44.7536713,-197.8999542,28.8720358,346.2367809,-53.5859997,84.8965386,28.5832541,-28.0575786,-42.8577306]])

x_norm = {'base': np.array([-12.58000, -13.13000, -7.27000, -53.00000, -74.03000, -52.00000, -35.40461, -230.00000, -34.00743, -11.89000]),
          'spread': np.array([45.33000, 45.84000, 15.15000, 85.00000, 152.83000, 84.00000, 71.41800, 417.00000, 70.92083, 55.61000])}

y_norm = {'base': 0, 'spread': 1}

nn = brnn.BRNN(feat, theta, x_norm, y_norm)

X = np.array([[20.83, 20.23, -6.55, -30, -19.65, -15, -3.3111306, 45, -0.4312568, 11.95],
              [21.50, 20.83, -5.03, -15, -35.21, 0, -0.4312568, 105, 1.4405876, 5.40],
              [23.40, 23.22, -1.19, 22, -2.38, 23, -0.2392033, 2, 0.6456441, -8.06],
              [24.05, 23.65, 6.52, 1, 58.68, 16, 2.3744465, -135, 3.4491164, 2.07],
              [23.65, 22.96, 5.68, -15, 22.72, 1, 1.7399884, -64, 3.4491164, 7.75],
              [22.03, 21.20, 2.46, -25, 27.06, -23, 0.5747320, -22, 1.5739968, 13.72]])
print(nn.predict(X))
